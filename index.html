<!-- Comentario de teste adicionado -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#1F2937" />
    <title>Preview - Central de Controle</title>
    <base href="./" />
    <link rel="preload" href="assets/logo_comau_azul.png" as="image" />
    <link rel="stylesheet" href="style.css" />
    <link rel="prefetch" href="ControleStatus.html" />
    <link rel="prefetch" href="Simulacao.html" />
</head>
<body>
    <header class="top-header">
        <div class="brand">
            <img src="assets/logo_comau_azul.png" alt="Comau" class="brand-logo" />
            <div class="brand-info">
                <strong class="brand-title">Central de Controle</strong>
                <span class="brand-sub">HTML/JS Preview - Comau</span>
            </div>
        </div>
    <div class="header-actions">
        <a class="btn btn-icon" title="Recarregar" aria-label="Recarregar" href="index.html">
            <svg viewBox="0 0 24 24" class="icon" aria-hidden="true">
                <path d="M12 6a6 6 0 1 1-4.24 10.24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                <path d="M3 6h6v6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
        </a>
    </div>
    </header>

    <main class="app-content">
        <section class="page-header">
            <h1>Central de Controle</h1>
            <div class="center" style="gap:8px;flex-wrap:wrap">
                <span class="badge">Visao geral dos projetos</span>
                <button class="btn ghost" id="btn-clear-dados">Limpar todos os dados</button>
            </div>
        </section>

        <section class="hub-grid">
            <a class="hub-card" href="ControleStatus.html">
                <svg class="hub-card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z" />
                </svg>
                <h2>Projetos Mecanicos</h2>
                <p>Painel de controle de classes, dispositivos, cronograma, dashboard e recurso.</p>
            </a>

            <a class="hub-card" href="Simulacao.html">
                <svg class="hub-card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14.5 13.04L5.83 18.87a.5.5 0 0 1-.74-.55l.8-4.4a.5.5 0 0 0-.16-.5L2.2 9.87a.5.5 0 0 1 .28-.86l4.5-.3a.5.5 0 0 0 .43-.28l1.7-4a.5.5 0 0 1 .9 0l1.7 4a.5.5 0 0 0 .43.28l4.5.3a.5.5 0 0 1 .28.86l-3.53 3.55a.5.5 0 0 0-.16.5l.8 4.4a.5.5 0 0 1-.74.55l-8.67-5.83Z" />
                    <path d="M18.5 13.04L21.8 14.87a.5.5 0 0 1 .28.86l-3.53 3.55a.5.5 0 0 0-.16.5l.8 4.4a.5.5 0 0 1-.74.55l-3.3-2.21" />
                </svg>
                <h2>Gestao de Simulacao</h2>
                <p>Kanban para liberar dispositivos concluidos e gerenciar robos.</p>
            </a>
        </section>

        <section class="card mt-4">
            <div class="grid grid-3" id="hub-stats">
                <div class="kpi">
                    <div class="kpi-title">Projetos</div>
                    <div class="kpi-value" id="hub-kpi-projetos">0</div>
                    <small class="kpi-sub">ativos</small>
                </div>
                <div class="kpi">
                    <div class="kpi-title">Dispositivos</div>
                    <div class="kpi-value" id="hub-kpi-dispositivos">0</div>
                    <small class="kpi-sub">cadastrados</small>
                </div>
                <div class="kpi">
                    <div class="kpi-title">Proximos Marcos</div>
                    <div class="kpi-value" id="hub-kpi-marcos">0</div>
                    <small class="kpi-sub">nos proximos 30 dias</small>
                </div>
            </div>
        </section>
    </main>

    <div class="toast-container" id="toast-container"></div>

    <script type="module" src="app.js"></script>
    <script>
        const toast = (msg, type = 'ok') => {
            const t = document.getElementById('toast-container');
            if (!t) return;
            const el = document.createElement('div');
            el.className = `toast ${type}`;
            el.innerHTML = '<span class="dot"></span><div>' + msg + '</div>';
            t.appendChild(el);
            requestAnimationFrame(() => el.classList.add('show'));
            setTimeout(() => { el.classList.remove('show'); setTimeout(() => el.remove(), 250); }, 2800);
        };

        const atualizarKPIs = () => {
            const raw = localStorage.getItem('ps:metrics:v2') || localStorage.getItem('ps:metrics') || '{}';
            const m = JSON.parse(raw);
            document.getElementById('hub-kpi-projetos').textContent = (m.projetos ?? 1).toString();
            document.getElementById('hub-kpi-dispositivos').textContent = (m.dispositivos ?? 0).toString();
            document.getElementById('hub-kpi-marcos').textContent = (m.marcos ?? 0).toString();
        };

        const clearAll = () => {
            localStorage.removeItem('ps:state');
            localStorage.removeItem('ps:metrics');
            localStorage.removeItem('ps:metrics:v2');
            localStorage.removeItem('ps:snapshots');
            try { new BroadcastChannel('ps:bus').postMessage({ t: 'state:update' }); } catch { }
            atualizarKPIs();
            toast('Dados limpos.', 'ok');
        };

        document.addEventListener('DOMContentLoaded', () => {
            atualizarKPIs();
            document.getElementById('btn-clear-dados')?.addEventListener('click', clearAll);
        });
    </script>
</body>
</html>
